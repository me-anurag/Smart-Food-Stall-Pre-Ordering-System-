{% extends "base.html" %}

{% block content %}

<div class="row justify-content-center">
    <div class="col-lg-6">

        <div class="card shadow border-0">
            <div class="card-body p-4">

                <h4 class="mb-4 text-center">Secure Payment</h4>

                <div class="border rounded p-3 mb-4 bg-light">
                    <p><strong>Item:</strong> {{ item_name }}</p>
                    <p><strong>Quantity:</strong> {{ quantity }}</p>
                    <p><strong>Time Slot:</strong> {{ time_slot }}</p>
                    <h5 class="text-end">Total: ₹{{ total_price }}</h5>
                </div>

                <form method="POST" action="/confirm-payment" id="paymentForm">

                    <input type="hidden" name="item_name" value="{{ item_name }}">
                    <input type="hidden" name="quantity" value="{{ quantity }}">
                    <input type="hidden" name="time_slot" value="{{ time_slot }}">
                    <input type="hidden" name="total_price" value="{{ total_price }}">
                    <input type="hidden" name="payment_method" id="selectedMethod">

                    <h6 class="mb-3">Choose UPI App</h6>

                    <div class="d-flex justify-content-between mb-4">

                        <div class="text-center">
                            <img src="{{ url_for('static', filename='images/gpay.png') }}"
                                 width="80"
                                 onclick="selectPayment('Google Pay')"
                                 class="payment-logo">
                            <div>Google Pay</div>
                        </div>

                        <div class="text-center">
                            <img src="{{ url_for('static', filename='images/phonepe.png') }}"
                                 width="80"
                                 onclick="selectPayment('PhonePe')"
                                 class="payment-logo">
                            <div>PhonePe</div>
                        </div>

                        <div class="text-center">
                            <img src="{{ url_for('static', filename='images/paytm.png') }}"
                                 width="80"
                                 onclick="selectPayment('Paytm')"
                                 class="payment-logo">
                            <div>Paytm</div>
                        </div>

                    </div>

                    <div class="border rounded p-4 text-center mb-4 bg-white shadow-sm">
                        <div style="height:150px; background:#f0f0f0; display:flex; align-items:center; justify-content:center;">
                            QR Code Preview
                        </div>
                        <small class="text-muted">Scan to Pay</small>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-dark" id="payBtn">
                            Pay ₹{{ total_price }}
                        </button>
                    </div>

                </form>

            </div>
        </div>

    </div>
</div>

<style>
.payment-logo {
    cursor: pointer;
    padding: 10px;
    border-radius: 10px;
    transition: 0.3s;
}

.payment-logo:hover {
    transform: scale(1.1);
    background-color: #f8f9fa;
}
.selected {
    border: 2px solid black;
}
</style>

<script>
function selectPayment(method) {

    document.getElementById("selectedMethod").value = method;

    var logos = document.querySelectorAll(".payment-logo");
    logos.forEach(l => l.classList.remove("selected"));

    event.target.classList.add("selected");
}

document.getElementById("paymentForm").addEventListener("submit", function() {

    var btn = document.getElementById("payBtn");
    btn.innerText = "Processing Payment...";
    btn.disabled = true;
});
</script>

{% endblock %}